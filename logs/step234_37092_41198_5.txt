Starting...
Index: b = 37092, e = 41198, i = 5
Using GPUs: 4
CUDA available, using GPU(s): 4
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.43s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:03<00:03,  1.62s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:04<00:01,  1.70s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Processing dataset...
Processing /home/ltnghia02/dataset/37092/37092.5
This is a friendly reminder - the current text generation call will exceed the model's predefined maximum length (8192). Depending on the model, you may observe exceptions, performance degradation, or nothing at all.
DONE: 58.54s
Processing /home/ltnghia02/dataset/37097/37097.5
DONE: 150.47s
Processing /home/ltnghia02/dataset/37100/37100.5
DONE: 169.17s
Processing /home/ltnghia02/dataset/37106/37106.5
DONE: 120.43s
Processing /home/ltnghia02/dataset/37126/37126.5
DONE: 130.95s
Processing /home/ltnghia02/dataset/37156/37156.5
DONE: 127.18s
Processing /home/ltnghia02/dataset/37161/37161.5
DONE: 119.59s
Processing /home/ltnghia02/dataset/37165/37165.5
DONE: 137.68s
Processing /home/ltnghia02/dataset/37171/37171.5
DONE: 177.08s
Processing /home/ltnghia02/dataset/37181/37181.5
DONE: 166.31s
Processing /home/ltnghia02/dataset/37189/37189.5
DONE: 116.81s
Processing /home/ltnghia02/dataset/37192/37192.5
DONE: 153.66s
Processing /home/ltnghia02/dataset/37199/37199.5
DONE: 112.18s
Processing /home/ltnghia02/dataset/37204/37204.5
DONE: 134.10s
Processing /home/ltnghia02/dataset/37215/37215.5
DONE: 120.24s
Processing /home/ltnghia02/dataset/37225/37225.5
DONE: 130.62s
Processing /home/ltnghia02/dataset/37231/37231.5
DONE: 123.68s
Processing /home/ltnghia02/dataset/37252/37252.5
DONE: 139.25s
Processing /home/ltnghia02/dataset/37255/37255.5
DONE: 111.58s
Processing /home/ltnghia02/dataset/37256/37256.5
DONE: 114.55s
Processing /home/ltnghia02/dataset/37259/37259.5
DONE: 132.31s
Processing /home/ltnghia02/dataset/37260/37260.5
DONE: 91.90s
Processing /home/ltnghia02/dataset/37270/37270.5
DONE: 132.53s
Processing /home/ltnghia02/dataset/37292/37292.5
DONE: 208.54s
Processing /home/ltnghia02/dataset/37314/37314.5
DONE: 103.31s
Processing /home/ltnghia02/dataset/37319/37319.5
DONE: 127.97s
Processing /home/ltnghia02/dataset/37328/37328.5
DONE: 112.50s
Processing /home/ltnghia02/dataset/37332/37332.5
DONE: 135.90s
Processing /home/ltnghia02/dataset/37340/37340.5
Short file missing: /home/ltnghia02/dataset/37340/37340.5/short.txt
Processing /home/ltnghia02/dataset/37349/37349.5
Short file missing: /home/ltnghia02/dataset/37349/37349.5/short.txt
Processing /home/ltnghia02/dataset/37393/37393.5
Short file missing: /home/ltnghia02/dataset/37393/37393.5/short.txt
Processing /home/ltnghia02/dataset/37394/37394.5
Short file missing: /home/ltnghia02/dataset/37394/37394.5/short.txt
Processing /home/ltnghia02/dataset/37401/37401.5
Short file missing: /home/ltnghia02/dataset/37401/37401.5/short.txt
Processing /home/ltnghia02/dataset/37448/37448.5
DONE: 153.03s
Processing /home/ltnghia02/dataset/37457/37457.5
DONE: 61.95s
Processing /home/ltnghia02/dataset/37469/37469.5
DONE: 139.85s
Processing /home/ltnghia02/dataset/37478/37478.5
DONE: 131.45s
Processing /home/ltnghia02/dataset/37482/37482.5
DONE: 151.99s
Processing /home/ltnghia02/dataset/37483/37483.5
DONE: 170.02s
Processing /home/ltnghia02/dataset/37490/37490.5
DONE: 73.91s
Processing /home/ltnghia02/dataset/37491/37491.5
DONE: 128.30s
Processing /home/ltnghia02/dataset/37500/37500.5
DONE: 153.63s
Processing /home/ltnghia02/dataset/37523/37523.5
DONE: 140.02s
Processing /home/ltnghia02/dataset/37553/37553.5
DONE: 127.19s
Processing /home/ltnghia02/dataset/37557/37557.5
DONE: 137.88s
Processing /home/ltnghia02/dataset/37595/37595.5
DONE: 150.28s
Processing /home/ltnghia02/dataset/37612/37612.5
DONE: 123.21s
Processing /home/ltnghia02/dataset/37614/37614.5
DONE: 147.67s
Processing /home/ltnghia02/dataset/37618/37618.5
DONE: 159.82s
Processing /home/ltnghia02/dataset/37630/37630.5
DONE: 129.05s
Processing /home/ltnghia02/dataset/37642/37642.5
DONE: 175.16s
Processing /home/ltnghia02/dataset/37644/37644.5
DONE: 149.47s
Processing /home/ltnghia02/dataset/37656/37656.5
DONE: 158.18s
Processing /home/ltnghia02/dataset/37660/37660.5
DONE: 161.78s
Processing /home/ltnghia02/dataset/37664/37664.5
DONE: 123.64s
Processing /home/ltnghia02/dataset/37670/37670.5
DONE: 143.12s
Processing /home/ltnghia02/dataset/37671/37671.5
DONE: 104.30s
Processing /home/ltnghia02/dataset/37672/37672.5
DONE: 55.81s
Processing /home/ltnghia02/dataset/37680/37680.5
DONE: 188.81s
Processing /home/ltnghia02/dataset/37684/37684.5
DONE: 82.06s
Processing /home/ltnghia02/dataset/37685/37685.5
DONE: 47.33s
Processing /home/ltnghia02/dataset/37693/37693.5
DONE: 86.52s
Processing /home/ltnghia02/dataset/37702/37702.5
DONE: 152.43s
Processing /home/ltnghia02/dataset/37704/37704.5
DONE: 136.22s
Processing /home/ltnghia02/dataset/37715/37715.5
DONE: 67.92s
Processing /home/ltnghia02/dataset/37730/37730.5
DONE: 141.97s
Processing /home/ltnghia02/dataset/37731/37731.5
DONE: 164.92s
Processing /home/ltnghia02/dataset/37749/37749.5
DONE: 114.22s
Processing /home/ltnghia02/dataset/37759/37759.5
DONE: 130.20s
Processing /home/ltnghia02/dataset/37769/37769.5
DONE: 142.50s
Processing /home/ltnghia02/dataset/37780/37780.5
DONE: 175.07s
Processing /home/ltnghia02/dataset/37785/37785.5
DONE: 151.92s
Processing /home/ltnghia02/dataset/37788/37788.5
DONE: 173.99s
Processing /home/ltnghia02/dataset/37789/37789.5
DONE: 126.06s
Processing /home/ltnghia02/dataset/37798/37798.5
DONE: 160.38s
Processing /home/ltnghia02/dataset/37801/37801.5
DONE: 116.85s
Processing /home/ltnghia02/dataset/37806/37806.5
DONE: 174.32s
Processing /home/ltnghia02/dataset/37818/37818.5
DONE: 117.99s
Processing /home/ltnghia02/dataset/37831/37831.5
DONE: 207.99s
Processing /home/ltnghia02/dataset/37886/37886.5
DONE: 120.17s
Processing /home/ltnghia02/dataset/37905/37905.5
DONE: 170.05s
Processing /home/ltnghia02/dataset/37917/37917.5
DONE: 116.46s
Processing /home/ltnghia02/dataset/37937/37937.5
DONE: 148.91s
Processing /home/ltnghia02/dataset/37941/37941.5
DONE: 129.84s
Processing /home/ltnghia02/dataset/37944/37944.5
DONE: 66.08s
Processing /home/ltnghia02/dataset/37956/37956.5
DONE: 139.12s
Processing /home/ltnghia02/dataset/37957/37957.5
DONE: 143.52s
Processing /home/ltnghia02/dataset/37960/37960.5
DONE: 132.59s
Processing /home/ltnghia02/dataset/37963/37963.5
DONE: 164.36s
Processing /home/ltnghia02/dataset/37985/37985.5
DONE: 151.86s
Processing /home/ltnghia02/dataset/37989/37989.5
DONE: 143.50s
Processing /home/ltnghia02/dataset/38002/38002.5
DONE: 162.05s
Processing /home/ltnghia02/dataset/38003/38003.5
DONE: 124.63s
Processing /home/ltnghia02/dataset/38005/38005.5
DONE: 160.43s
Processing /home/ltnghia02/dataset/38012/38012.5
DONE: 158.24s
Processing /home/ltnghia02/dataset/38032/38032.5
DONE: 137.92s
Processing /home/ltnghia02/dataset/38054/38054.5
DONE: 131.57s
Processing /home/ltnghia02/dataset/38065/38065.5
DONE: 129.84s
Processing /home/ltnghia02/dataset/38076/38076.5
DONE: 132.14s
Processing /home/ltnghia02/dataset/38102/38102.5
DONE: 139.99s
Processing /home/ltnghia02/dataset/38105/38105.5
DONE: 166.32s
Processing /home/ltnghia02/dataset/38106/38106.5
DONE: 115.12s
Processing /home/ltnghia02/dataset/38111/38111.5
DONE: 100.21s
Processing /home/ltnghia02/dataset/38112/38112.5
DONE: 149.08s
Processing /home/ltnghia02/dataset/38114/38114.5
DONE: 132.32s
Processing /home/ltnghia02/dataset/38131/38131.5
DONE: 129.45s
Processing /home/ltnghia02/dataset/38145/38145.5
DONE: 130.54s
Processing /home/ltnghia02/dataset/38147/38147.5
DONE: 111.49s
Processing /home/ltnghia02/dataset/38149/38149.5
DONE: 144.75s
Processing /home/ltnghia02/dataset/38160/38160.5
DONE: 122.37s
Processing /home/ltnghia02/dataset/38168/38168.5
DONE: 123.16s
Processing /home/ltnghia02/dataset/38198/38198.5
DONE: 136.53s
Processing /home/ltnghia02/dataset/38210/38210.5
DONE: 132.66s
Processing /home/ltnghia02/dataset/38227/38227.5
DONE: 141.05s
Processing /home/ltnghia02/dataset/38234/38234.5
DONE: 134.83s
Processing /home/ltnghia02/dataset/38248/38248.5
DONE: 167.92s
Processing /home/ltnghia02/dataset/38250/38250.5
DONE: 161.49s
Processing /home/ltnghia02/dataset/38275/38275.5
DONE: 157.54s
Processing /home/ltnghia02/dataset/38282/38282.5
DONE: 145.75s
Processing /home/ltnghia02/dataset/38304/38304.5
DONE: 150.28s
Processing /home/ltnghia02/dataset/38323/38323.5
DONE: 159.19s
Processing /home/ltnghia02/dataset/38328/38328.5
DONE: 191.75s
Processing /home/ltnghia02/dataset/38336/38336.5
DONE: 151.89s
Processing /home/ltnghia02/dataset/38343/38343.5
DONE: 126.00s
Processing /home/ltnghia02/dataset/38364/38364.5
DONE: 92.69s
Processing /home/ltnghia02/dataset/38372/38372.5
DONE: 159.86s
Processing /home/ltnghia02/dataset/38376/38376.5
DONE: 127.86s
Processing /home/ltnghia02/dataset/38382/38382.5
DONE: 141.76s
Processing /home/ltnghia02/dataset/38396/38396.5
DONE: 164.71s
Processing /home/ltnghia02/dataset/38427/38427.5
DONE: 174.40s
Processing /home/ltnghia02/dataset/38441/38441.5
DONE: 131.25s
Processing /home/ltnghia02/dataset/38448/38448.5
DONE: 147.30s
Processing /home/ltnghia02/dataset/38452/38452.5
DONE: 147.82s
Processing /home/ltnghia02/dataset/38453/38453.5
DONE: 169.33s
Processing /home/ltnghia02/dataset/38458/38458.5
DONE: 153.69s
Processing /home/ltnghia02/dataset/38462/38462.5
DONE: 146.15s
Processing /home/ltnghia02/dataset/38469/38469.5
DONE: 123.89s
Processing /home/ltnghia02/dataset/38480/38480.5
DONE: 128.67s
Processing /home/ltnghia02/dataset/38481/38481.5
DONE: 131.36s
Processing /home/ltnghia02/dataset/38489/38489.5
DONE: 138.56s
Processing /home/ltnghia02/dataset/38510/38510.5
DONE: 125.93s
Processing /home/ltnghia02/dataset/38517/38517.5
DONE: 155.44s
Processing /home/ltnghia02/dataset/38525/38525.5
DONE: 116.82s
Processing /home/ltnghia02/dataset/38526/38526.5
DONE: 122.04s
Processing /home/ltnghia02/dataset/38529/38529.5
DONE: 121.29s
Processing /home/ltnghia02/dataset/38540/38540.5
DONE: 171.26s
Processing /home/ltnghia02/dataset/38542/38542.5
DONE: 141.49s
Processing /home/ltnghia02/dataset/38554/38554.5
DONE: 184.41s
Processing /home/ltnghia02/dataset/38577/38577.5
DONE: 137.42s
Processing /home/ltnghia02/dataset/38609/38609.5
DONE: 159.96s
Processing /home/ltnghia02/dataset/38638/38638.5
DONE: 128.30s
Processing /home/ltnghia02/dataset/38669/38669.5
DONE: 194.01s
Processing /home/ltnghia02/dataset/38699/38699.5
DONE: 156.49s
Processing /home/ltnghia02/dataset/38717/38717.5
DONE: 99.80s
Processing /home/ltnghia02/dataset/38719/38719.5
DONE: 117.91s
Processing /home/ltnghia02/dataset/38754/38754.5
DONE: 181.90s
Processing /home/ltnghia02/dataset/38758/38758.5
DONE: 155.21s
Processing /home/ltnghia02/dataset/38768/38768.5
DONE: 160.88s
Processing /home/ltnghia02/dataset/38776/38776.5
DONE: 161.90s
Processing /home/ltnghia02/dataset/38797/38797.5
DONE: 122.43s
Processing /home/ltnghia02/dataset/38798/38798.5
DONE: 159.01s
Processing /home/ltnghia02/dataset/38804/38804.5
DONE: 126.21s
Processing /home/ltnghia02/dataset/38810/38810.5
DONE: 152.74s
Processing /home/ltnghia02/dataset/38813/38813.5
DONE: 102.31s
Processing /home/ltnghia02/dataset/38831/38831.5
DONE: 153.12s
Processing /home/ltnghia02/dataset/38854/38854.5
DONE: 188.76s
Processing /home/ltnghia02/dataset/38874/38874.5
DONE: 139.83s
Processing /home/ltnghia02/dataset/38880/38880.5
DONE: 157.83s
Processing /home/ltnghia02/dataset/38885/38885.5
DONE: 140.28s
Processing /home/ltnghia02/dataset/38890/38890.5
DONE: 138.80s
Processing /home/ltnghia02/dataset/38908/38908.5
DONE: 96.52s
Processing /home/ltnghia02/dataset/38926/38926.5
DONE: 120.22s
Processing /home/ltnghia02/dataset/38945/38945.5
DONE: 130.26s
Processing /home/ltnghia02/dataset/38957/38957.5
DONE: 148.15s
Processing /home/ltnghia02/dataset/38964/38964.5
DONE: 122.39s
Processing /home/ltnghia02/dataset/38966/38966.5
DONE: 161.85s
Processing /home/ltnghia02/dataset/38967/38967.5
DONE: 162.86s
Processing /home/ltnghia02/dataset/38988/38988.5
DONE: 163.29s
Processing /home/ltnghia02/dataset/39008/39008.5
DONE: 124.95s
Processing /home/ltnghia02/dataset/39030/39030.5
DONE: 186.90s
Processing /home/ltnghia02/dataset/39031/39031.5
DONE: 124.85s
Processing /home/ltnghia02/dataset/39034/39034.5
DONE: 74.77s
Processing /home/ltnghia02/dataset/39042/39042.5
DONE: 171.02s
Processing /home/ltnghia02/dataset/39045/39045.5
DONE: 120.60s
Processing /home/ltnghia02/dataset/39052/39052.5
DONE: 147.47s
Processing /home/ltnghia02/dataset/39065/39065.5
DONE: 117.82s
Processing /home/ltnghia02/dataset/39103/39103.5
DONE: 136.76s
Processing /home/ltnghia02/dataset/39113/39113.5
DONE: 159.78s
Processing /home/ltnghia02/dataset/39125/39125.5
DONE: 124.15s
Processing /home/ltnghia02/dataset/39146/39146.5
DONE: 129.13s
Processing /home/ltnghia02/dataset/39171/39171.5
DONE: 83.07s
Processing /home/ltnghia02/dataset/39172/39172.5
DONE: 72.14s
Processing /home/ltnghia02/dataset/39174/39174.5
DONE: 93.26s
Processing /home/ltnghia02/dataset/39177/39177.5
DONE: 126.47s
Processing /home/ltnghia02/dataset/39179/39179.5
DONE: 108.10s
Processing /home/ltnghia02/dataset/39184/39184.5
DONE: 131.96s
Processing /home/ltnghia02/dataset/39197/39197.5
DONE: 124.67s
Processing /home/ltnghia02/dataset/39207/39207.5
DONE: 140.87s
Processing /home/ltnghia02/dataset/39209/39209.5
DONE: 123.28s
Processing /home/ltnghia02/dataset/39219/39219.5
DONE: 117.80s
Processing /home/ltnghia02/dataset/39231/39231.5
DONE: 167.33s
Processing /home/ltnghia02/dataset/39234/39234.5
DONE: 104.72s
Processing /home/ltnghia02/dataset/39245/39245.5
DONE: 156.37s
Processing /home/ltnghia02/dataset/39255/39255.5
DONE: 115.64s
Processing /home/ltnghia02/dataset/39262/39262.5
DONE: 240.53s
Processing /home/ltnghia02/dataset/39281/39281.5
DONE: 155.23s
Processing /home/ltnghia02/dataset/39293/39293.5
DONE: 169.14s
Processing /home/ltnghia02/dataset/39314/39314.5
DONE: 117.15s
Processing /home/ltnghia02/dataset/39318/39318.5
DONE: 83.86s
Processing /home/ltnghia02/dataset/39320/39320.5
DONE: 178.79s
Processing /home/ltnghia02/dataset/39340/39340.5
DONE: 157.02s
Processing /home/ltnghia02/dataset/39357/39357.5
DONE: 169.03s
Processing /home/ltnghia02/dataset/39363/39363.5
DONE: 171.55s
Processing /home/ltnghia02/dataset/39373/39373.5
DONE: 200.12s
Processing /home/ltnghia02/dataset/39396/39396.5
DONE: 186.93s
Processing /home/ltnghia02/dataset/39400/39400.5
DONE: 122.77s
Processing /home/ltnghia02/dataset/39430/39430.5
DONE: 163.09s
Processing /home/ltnghia02/dataset/39431/39431.5
DONE: 123.10s
Processing /home/ltnghia02/dataset/39440/39440.5
DONE: 190.35s
Processing /home/ltnghia02/dataset/39447/39447.5
DONE: 100.74s
Processing /home/ltnghia02/dataset/39449/39449.5
DONE: 130.26s
Processing /home/ltnghia02/dataset/39474/39474.5
DONE: 104.27s
Processing /home/ltnghia02/dataset/39481/39481.5
DONE: 184.16s
Processing /home/ltnghia02/dataset/39482/39482.5
DONE: 159.82s
Processing /home/ltnghia02/dataset/39487/39487.5
DONE: 121.85s
Processing /home/ltnghia02/dataset/39502/39502.5
DONE: 139.52s
Processing /home/ltnghia02/dataset/39526/39526.5
DONE: 152.04s
Processing /home/ltnghia02/dataset/39537/39537.5
DONE: 133.61s
Processing /home/ltnghia02/dataset/39565/39565.5
DONE: 127.88s
Processing /home/ltnghia02/dataset/39566/39566.5
DONE: 139.83s
Processing /home/ltnghia02/dataset/39567/39567.5
DONE: 166.76s
Processing /home/ltnghia02/dataset/39602/39602.5
DONE: 140.91s
Processing /home/ltnghia02/dataset/39624/39624.5
DONE: 184.56s
Processing /home/ltnghia02/dataset/39625/39625.5
DONE: 130.65s
Processing /home/ltnghia02/dataset/39637/39637.5
DONE: 149.36s
Processing /home/ltnghia02/dataset/39654/39654.5
DONE: 163.52s
Processing /home/ltnghia02/dataset/39658/39658.5
DONE: 150.75s
Processing /home/ltnghia02/dataset/39684/39684.5
DONE: 143.38s
Processing /home/ltnghia02/dataset/39697/39697.5
DONE: 140.51s
Processing /home/ltnghia02/dataset/39708/39708.5
DONE: 121.82s
Processing /home/ltnghia02/dataset/39720/39720.5
DONE: 162.76s
Processing /home/ltnghia02/dataset/39723/39723.5
DONE: 146.19s
Processing /home/ltnghia02/dataset/39740/39740.5
DONE: 134.54s
Processing /home/ltnghia02/dataset/39746/39746.5
DONE: 162.85s
Processing /home/ltnghia02/dataset/39777/39777.5
DONE: 174.05s
Processing /home/ltnghia02/dataset/39808/39808.5
DONE: 128.08s
Processing /home/ltnghia02/dataset/39817/39817.5
DONE: 149.34s
Processing /home/ltnghia02/dataset/39831/39831.5
DONE: 158.14s
Processing /home/ltnghia02/dataset/39839/39839.5
DONE: 156.42s
Processing /home/ltnghia02/dataset/39847/39847.5
DONE: 165.04s
Processing /home/ltnghia02/dataset/39856/39856.5
DONE: 136.13s
Processing /home/ltnghia02/dataset/39859/39859.5
DONE: 175.45s
Processing /home/ltnghia02/dataset/39868/39868.5
DONE: 160.97s
Processing /home/ltnghia02/dataset/39888/39888.5
DONE: 130.98s
Processing /home/ltnghia02/dataset/39892/39892.5
DONE: 139.27s
Processing /home/ltnghia02/dataset/39905/39905.5
DONE: 115.30s
Processing /home/ltnghia02/dataset/39909/39909.5
DONE: 160.56s
Processing /home/ltnghia02/dataset/39934/39934.5
DONE: 115.66s
Processing /home/ltnghia02/dataset/39951/39951.5
DONE: 95.18s
Processing /home/ltnghia02/dataset/39977/39977.5
DONE: 153.15s
Processing /home/ltnghia02/dataset/39993/39993.5
DONE: 99.84s
Processing /home/ltnghia02/dataset/39999/39999.5
DONE: 141.73s
Processing /home/ltnghia02/dataset/40035/40035.5
DONE: 251.18s
Processing /home/ltnghia02/dataset/40037/40037.5
DONE: 300.51s
Processing /home/ltnghia02/dataset/40038/40038.5
DONE: 187.00s
Processing /home/ltnghia02/dataset/40074/40074.5
Short file missing: /home/ltnghia02/dataset/40074/40074.5/short.txt
Processing /home/ltnghia02/dataset/40093/40093.5
Short file missing: /home/ltnghia02/dataset/40093/40093.5/short.txt
Processing /home/ltnghia02/dataset/40132/40132.5
DONE: 1810.46s
Processing /home/ltnghia02/dataset/40161/40161.5
DONE: 3023.37s
Processing /home/ltnghia02/dataset/40218/40218.5
DONE: 134.68s
Processing /home/ltnghia02/dataset/40234/40234.5
Traceback (most recent call last):
  File "/home/ltnghia02/vischronos/scripts/second.py", line 248, in <module>
    process_all_steps(args.dataset_path, args.prompt_path, args.img_index, args.begin_index, args.end_index)
  File "/home/ltnghia02/vischronos/scripts/second.py", line 205, in process_all_steps
    prompt, answer = process_step_3(caption, question, knowledge, prompts[2])
  File "/home/ltnghia02/vischronos/scripts/second.py", line 93, in process_step_3
    generated_text = generate_text(detailed_prompt)
  File "/home/ltnghia02/vischronos/scripts/second.py", line 69, in generate_text
    outputs = model.generate(
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/transformers/generation/utils.py", line 2215, in generate
    result = self._sample(
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/transformers/generation/utils.py", line 3206, in _sample
    outputs = self(**model_inputs, return_dict=True)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/transformers/models/gemma2/modeling_gemma2.py", line 1049, in forward
    outputs = self.model(
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/transformers/models/gemma2/modeling_gemma2.py", line 837, in forward
    layer_outputs = decoder_layer(
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/transformers/models/gemma2/modeling_gemma2.py", line 553, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/transformers/models/gemma2/modeling_gemma2.py", line 255, in forward
    attn_weights = nn.functional.softmax(attn_weights, dim=-1, dtype=torch.float32).to(query_states.dtype)
  File "/home/ltnghia02/env1/lib/python3.10/site-packages/torch/nn/functional.py", line 2142, in softmax
    ret = input.softmax(dim, dtype=dtype)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 4.17 GiB. GPU 0 has a total capacity of 79.14 GiB of which 3.05 GiB is free. Including non-PyTorch memory, this process has 30.30 GiB memory in use. Process 3481887 has 45.77 GiB memory in use. Of the allocated memory 27.01 GiB is allocated by PyTorch, and 2.79 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
